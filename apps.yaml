# apps.yaml
# Agent Instruction: Read this file to determine what software to install.

groups:
  core_utils:
    description: "Essential system tools and package managers"
    items:
      - name: deb-get
        verify_cmd: "which deb-get"
        version_cmd: "deb-get version"
        install_ref: "https://github.com/wimpysworld/deb-get"
        method: "script"
        notes: "Install this first; it helps install other .deb files."
      - name: curl
        verify_cmd: "which curl"
        version_cmd: "curl --version"
        method: "apt"
      - name: git
        verify_cmd: "which git"
        version_cmd: "git --version"
        method: "apt"
        notes: "On Debian Bookworm, this provides 2.39.x. For newer versions on Ubuntu-based systems, use ppa:git-core/ppa."
      - name: zsh
        verify_cmd: "which zsh"
        version_cmd: "zsh --version"
        method: "apt"
      - name: rustup
        verify_cmd: "which cargo"
        version_cmd: "cargo --version"
        install_ref: "https://rustup.rs/"
        method: "script"
        notes: "Installs rustc, cargo, and rustup. The script should add cargo to the PATH."
      - name: wget
        verify_cmd: "which wget"
        version_cmd: "wget --version"
        method: "apt"
      - name: lsb-release
        verify_cmd: "which lsb_release"
        version_cmd: "lsb_release -a"
        method: "apt"

  dev_cli:
    description: "Terminal tools and developer utilities"
    items:
      - name: zellij
        verify_cmd: "which zellij"
        version_cmd: "zellij --version"
        install_ref: "https://github.com/zellij-org/zellij/releases/latest/download/zellij-x86_64-unknown-linux-musl.tar.gz"
        method: "manual_binary"
        notes: "Manually download, extract, and move binary to /usr/local/bin."
      - name: gh
        verify_cmd: "which gh"
        version_cmd: "gh --version"
        install_ref: "https://cli.github.com/"
        method: "deb-get"
        notes: "Use `deb-get install --quiet gh`. Be aware of potential interactive prompts."
      - name: uv
        verify_cmd: "which uv"
        version_cmd: "uv --version"
        install_ref: "https://docs.astral.sh/uv/"
        method: "script"
        notes: "The script should add uv to the PATH."
      - name: notebooklm-mcp-cli
        verify_cmd: "which nlm"
        version_cmd: "nlm --version"
        install_ref: "https://github.com/jacob-bd/notebooklm-mcp-cli"
        method: "uv"
        notes: "Installs the NotebookLM MCP CLI and server."
      - name: skills
        verify_cmd: "which skills"
        version_cmd: "skills --version"
        install_ref: "https://github.com/vercel-labs/skills"
        method: "npm"
        notes: "The open agent skills tool."
      - name: add-mcp
        verify_cmd: "which add-mcp"
        version_cmd: "add-mcp --version"
        install_ref: "https://github.com/neondatabase/add-mcp"
        method: "npm"
        notes: "The open MCP config tool."
      - name: glow
        verify_cmd: "which glow"
        version_cmd: "glow --version"
        method: "apt_with_repo"
        notes: |
          sudo mkdir -p /etc/apt/keyrings
          curl -fsSL https://repo.charm.sh/apt/gpg.key | sudo gpg --dearmor -o /etc/apt/keyrings/charm.gpg
          echo "deb [signed-by=/etc/apt/keyrings/charm.gpg] https://repo.charm.sh/apt/ * *" | sudo tee /etc/apt/sources.list.d/charm.list
          sudo apt update && sudo apt install glow -y
      - name: ripgrep
        verify_cmd: "which rg"
        version_cmd: "rg --version"
        method: "apt"
      - name: fd-find
        verify_cmd: "which fdfind"
        version_cmd: "fdfind --version"
        method: "apt"
        notes: "On Debian, the binary is 'fdfind'. LazyVim prefers 'fd'."
      - name: fzf
        verify_cmd: "which fzf"
        version_cmd: "fzf --version"
        method: "apt"
      - name: antidote
        verify_cmd: "test -d ~/.antidote"
        version_cmd: "git -C ~/.antidote rev-parse --short HEAD"
        install_ref: "https://github.com/mattmc3/antidote"
        method: "git_clone"
        notes: "Clones antidote to ~/.antidote and requires setup in .zshrc."

  editors:
    description: "Code editors and IDEs"
    items:
      - name: neovim
        verify_cmd: "bash -c 'v=$(nvim --version 2>/dev/null | head -n1 | cut -d\" \" -f2 | sed \"s/v//\"); [ -n \"$v\" ] && dpkg --compare-versions \"$v\" ge \"0.9.0\"'"
        version_cmd: "nvim --version"
        install_ref: "https://github.com/neovim/neovim/releases"
        method: "script"
        notes: |
          # This script ensures neovim is >= 0.9.0 for LazyVim.
          # 1. Try apt first. If version is < 0.9.0, install official AppImage.
          sudo apt update -qq && sudo apt install -qq neovim -y
          v=$(nvim --version 2>/dev/null | head -n1 | cut -d" " -f2 | sed "s/v//")
          if [ -z "$v" ] || dpkg --compare-versions "$v" lt "0.9.0"; then
            LATEST_URL=$(curl -s "https://api.github.com/repos/neovim/neovim/releases/latest" | grep "browser_download_url.*nvim.appimage"\" | cut -d : -f 2,3 | tr -d '\"' | head -n1)
            curl -LO $LATEST_URL
            chmod +x nvim.appimage
            sudo mv nvim.appimage /usr/local/bin/nvim
          fi
      - name: lazyvim
        verify_cmd: "test -d ~/.config/nvim"
        install_ref: "https://www.lazyvim.org/"
        method: "git_clone"
        depends_on: ["neovim"]
        notes: "Clones the LazyVim starter config. Depends on neovim."
      - name: code
        verify_cmd: "which code"
        version_cmd: "code --version"
        install_ref: "https://code.visualstudio.com/docs/setup/linux"
        method: "deb-get"
        notes: "Use `deb-get install --quiet code`. Be aware of potential interactive prompts."
      - name: antigravity
        verify_cmd: "which antigravity"
        version_cmd: "antigravity --version"
        install_ref: "https://antigravity.google/download/linux"
        method: "manual_download"

  browsers:
    description: "Web Browsers"
    items:
      - name: google-chrome-stable
        verify_cmd: "which google-chrome"
        version_cmd: "google-chrome-stable --version"
        install_ref: "https://www.google.com/chrome/"
        method: "deb-get"
        notes: "Use `deb-get install --quiet google-chrome-stable`. Be aware of potential EULA prompts."

# History of successful workarounds (Agent: Append new findings here)
install_notes:
  - "2024-02-14: If deb-get fails for Chrome, fallback to direct .deb download from Google."
  - "2026-02-13: `neovim` is not available via `deb-get`, fallback to `apt`."
  - "2026-02-13: `zellij` script installer can be brittle; direct binary download is more reliable."
  - "2026-02-14: Successfully installed `notebooklm-mcp-cli` using `uv tool install`."
  - "2026-02-14: Successfully installed `skills` CLI using `npm install -g --quiet skills`."
  - "2026-02-14: Successfully installed `add-mcp` CLI using `npm install -g --quiet add-mcp`."
  - "2026-02-14: Successfully installed `zsh` via `apt` and `antidote` via `git clone`, with setup in `.zshrc` and `.zsh_plugins.txt`."
  - "2026-02-14: Fixed Zsh initialization errors by adding `autoload -Uz compinit && compinit` before `antidote load` in `.zshrc`. This ensures `compdef` is available for plugins."
